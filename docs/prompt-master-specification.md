# プロンプトエンジニアリング マスターガイド

*最終更新: 2025年6月18日*

## 📖 このドキュメントについて

このガイドは、X_BUZZ_FLOWプロジェクトでの実装経験から得られた、Chain of Thoughtとプロンプト設計に関する深い知見をまとめたものです。特に「なぜ設計と実装が乖離するのか」「なぜ正しいものが一つもない状態になるのか」という問題の本質に迫ります。

## 🧠 第1部：Chain of Thoughtの本質

### Chain of Thoughtとは何か

Chain of Thought（CoT）は、LLMに「考えさせる」技術です。重要なのは：

- **考えさせる** ＝ 創造的な思考プロセスを促す
- **Chain（連鎖）** ＝ 前の思考が次の思考を導く
- **非決定的** ＝ 同じ入力でも異なる創造的な出力

### プログラミング的発想との決定的な違い

#### ❌ プログラミング的発想（関数的思考）
```javascript
function generateConcept(topic) {
  const hooks = ["意外性", "緊急性", "自己投影", "数字", "問い"];
  const selectedHook = hooks[Math.floor(Math.random() * hooks.length)];
  return {
    hook: selectedHook,
    content: generateContent(topic, selectedHook)
  };
}
```

#### ✅ Chain of Thought的発想（創造的思考）
```
「以下の5種類のフックを参考に、このトピックに最適なアプローチを考えてください。
なぜその組み合わせが効果的か、理由も含めて説明してください。」
```

### 創造性を殺す3つの罠

1. **選択肢の固定化**
   - 悪例：「以下から1つ選んでください」
   - 良例：「以下を参考に、組み合わせも含めて考えてください」

2. **テンプレート化**
   - 悪例：「[導入] → [本論] → [結論]の形式で」
   - 良例：「物語性のある魅力的な流れで」

3. **評価基準のハードコード**
   - 悪例：「スコア80以上のものを選択」
   - 良例：「なぜバズる可能性が高いか説明して」

## 📐 第2部：プロンプト設計の原則

### 原則1：入力と出力は1:1対応ではない

最も重要な理解：プロンプトのガイド部分とJSON出力は異なる役割を持つ。

#### 実例：フックと角度の設計
```
【ガイド部分】
- 5種類のフック（意外性、緊急性、自己投影、数字・ロジック、問い・未完性）
- 12種類の角度（反対派視点、専門家分析、個人体験談...）

【JSON出力】
{
  "hookType": "意外性",
  "hookCombination": ["意外性", "問い・未完性"],
  "angle": "専門家分析",
  "angleCombination": ["専門家分析", "個人体験談"],
  "angleRationale": "専門家の知見と実体験を組み合わせることで信頼性と共感性を両立"
}
```

**ポイント**：
- ガイドは「考える材料」（5種類×12種類の可能性）
- 出力は「考えた結果」（選択＋組み合わせ＋理由）
- LLMは創造的に新情報（angleRationale）を生成

### 原則2：逆算設計の必要性

各ステップの出力は、次のステップの入力として設計する。

```
Step 3（コンテンツ生成）が必要とする情報
  ↑
Step 2（コンセプト生成）の出力設計
  ↑
Step 1（トピック収集）の出力設計
```

#### 失敗例：独立設計の罠
```
Step 1: トピックを収集 → {title, url}
Step 2: コンセプトを生成 → {concept, score}
Step 3: コンテンツを生成 → エラー！angleRationaleがない！
```

### 原則3：非関数的な設計

#### 物語構造の例
```
【正しい設計】
「以下の5段階構造で、物語として一貫したコンテンツを作成してください：
1. オープニングフック
2. 背景／問題提起
3. 具体的な中身
4. 内省・共感
5. CTA」

【間違った設計】
generateHook();
generateBackground();
generateContent();
generateReflection();
generateCTA();
```

**なぜ間違いか**：
- 各要素がバラバラに生成される
- 前後の文脈が失われる
- 「オープニングが問いかけなら、CTAでその答えを」という連続性が生まれない

### 原則4：ガイドと出力形式の明確な分離

```
プロンプト = ガイド部分（自然言語）+ 出力指示（JSON形式）
```

- **ガイド部分**：LLMの思考を導く、創造性を促す
- **出力指示**：構造化されたデータ、DB保存可能、次フェーズで利用

## 🚨 第3部：実装上の落とし穴

### 落とし穴1：「3+5=8」問題

実際に起きた誤解の例：

```
プロンプト：「3つのコンセプトを、5段階の物語構造で作成してください」
  ↓
誤解：「3 + 5 = 8つのコンセプトを生成？」
  ↓
実装：8つのコンセプトを保存するDB設計
  ↓
破綻：次フェーズは3つ期待 → 8つある → エラー
```

**教訓**：ガイド要素を出力数と混同しない

### 落とし穴2：フィールド名の罠

LLMはフィールド名からも意図を推測する：

```json
// 問題のあるフィールド名
{
  "mainContent": "..."  // LLM：「主な内容でいいのか、概要でOK」
}

// 意図が明確なフィールド名
{
  "specificContent": "..."  // LLM：「具体的な内容が必要」
  "concreteStory": "..."    // LLM：「具体的なストーリーが必要」
}
```

**影響**：
- 高性能モデル：文脈から正しく理解
- 低性能モデル：フィールド名に引っ張られる

### 落とし穴3：エラーの連鎖

```
1. プロンプト誤解
   「8つのコンセプトを生成」
   ↓
2. DB設計の固定化
   8つ前提のスキーマ、マイグレーション実行
   ↓
3. APIの実装
   8つを処理するロジック
   ↓
4. フロントエンドの実装
   8つ表示するUI
   ↓
5. 次フェーズでエラー
   「3つのコンセプトのはずが8つある！」
   ↓
6. 間違った修正
   「前フェーズを8つに合わせよう」
   ↓
7. 全体が間違った方向に収束
```

**最悪の結果**：動くけど意図と違うシステム

## 🛠️ 第4部：実践的なガイドライン

### ガイドライン1：プロンプトの基本構造

```
【システムプロンプト】
あなたは〜です。（役割の一貫性）

【ユーザープロンプト】
1. コンテキスト（背景情報）
2. ガイド部分（考え方の指針）
   - 参考にすべき要素
   - 考慮すべき観点
   - 目指すべき方向性
3. 出力指示（JSON形式）
   - 必須フィールド
   - フィールドの説明
   - 出力例
```

### ガイドライン2：フィールド設計のベストプラクティス

#### 次フェーズから逆算する
```json
// Step 3で必要な情報を確認
{
  "conceptId": "識別子",
  "angle": "選択した角度",
  "angleRationale": "なぜこの角度が効果的か",  // Step 3で参照
  "structure": {
    "openingHook": "どう始めるか",           // Step 3で必要
    "background": "どんな問題提起をするか",    // Step 3で必要
    // ...
  }
}
```

#### 意図を明確にする命名
```json
// ❌ 曖昧
"content": "..."

// ✅ 明確
"specificExamples": "..."
"concreteStory": "..."
"detailedExplanation": "..."
```

### ガイドライン3：順序性の重要性

物語構造など、順序が重要な要素は：

1. **ガイドで順序を明示**
   ```
   「以下の順序で展開してください：
   1→2→3→4→5」
   ```

2. **出力でも順序を保持**
   ```json
   "structure": {
     "step1_hook": "...",
     "step2_background": "...",
     "step3_mainContent": "...",
     "step4_reflection": "...",
     "step5_cta": "..."
   }
   ```

### ガイドライン4：具体性の確保

```
❌ 「内容を生成してください」
✅ 「具体的な事例、数値、体験談を含む内容を生成してください」

❌ 「適切なフックを」
✅ 「読者が思わず続きを読みたくなる、意外性のあるフックを」
```

## 💡 第5部：V2システムの実装例

### 現在の実装（2025年6月18日）

#### 全体構成
- **2トピック × 3コンセプト = 6パターン**
- 各コンセプトは5段階の物語構造を内包

#### Step 1: トピック収集
```
入力：テーマ（例：AIと働き方）
処理：Perplexityで2つのトピックを収集
出力：{
  TOPIC, url, date, summary, keyPoints[],
  perplexityAnalysis, additionalSources[]
}
```

#### Step 2: コンセプト生成
```
入力：2つのトピック
処理：各トピックに3つのコンセプト（計6つ）
出力：{
  conceptId, format, 
  hookType, hookCombination[], 
  angle, angleCombination[],
  angleRationale,  // 新規生成
  viralScore,      // 新規生成
  viralFactors[],  // 新規生成
  structure: {     // 5段階の解釈
    openingHook, background, mainContent,
    reflection, cta
  },
  visual, timing, hashtags[]
}
```

#### Step 3: コンテンツ生成
```
入力：選択されたコンセプト
処理：実際の投稿文を生成
出力：完成した投稿コンテンツ
```

### 重要な実装ポイント

1. **トピックは2つに絞る**
   - 処理時間とコストの最適化
   - ユーザーの選択疲れを防ぐ

2. **コンセプトは3つずつ**
   - 多様性を保ちつつ選びやすい数
   - single, thread, carouselの3形式

3. **構造は各コンセプトに内包**
   - 5段階構造は別カウントしない
   - 各コンセプトが独自の展開を持つ

## 📋 第6部：プロンプトマスター仕様

### Step 1: トピック収集プロンプト（collect-topics）

#### バージョン: 2025年6月18日版（最新稼働版）

#### 変更履歴
- 2025年6月18日: 最新稼働版として記録（トピック数2つ、48時間以内のニュース必須）

#### システムプロンプト
```
あなたは、新たなトレンドを特定し、流行の波がピークに達する前にその波に乗るコンテンツのコンセプトを作成するバズるコンテンツ戦略家です。
```

#### ユーザープロンプト
```
【${theme}】について【${platform}】において【${style}】で発信するためのバズるコンテンツを作成したいです。

以下の視点でトレンド情報を収集・分析し、直近でバズリそうなトピックを2つ特定してください。

重要な要件：
- 必ず最低でも1つは48時間以内のニュースソースを含めてください
- 判断の元となったニュースソースのURLを全て明記してください（複数可）
- 各トピックごとに複数のソースがある場合は、additionalSourcesフィールドに含めてください

A：現在の出来事の分析
- ${theme}に関する最新ニュース（特に感情的な反応を引き起こしているもの）
- この分野での有名人の発言や事件と、それに対する世間の強い反応
- ${theme.split('と')[0]}と${theme.split('と')[1] || '労働'}に関する政治的議論で意見が分かれているもの

B：テクノロジーの発表とテクノロジードラマ
- ${theme.split('と')[0]}導入を巡る企業の対立や論争
- ${theme}の変化に関する文化的な衝突や社会運動
- 予想外の展開や驚きを生んだ事例
- インターネット上で話題になっているドラマチックな出来事

C：ソーシャルリスニング研究
- ${platform}で急速に広がっている${theme}のトレンドやハッシュタグ
- TikTokで話題の${theme.split('と')[0]}関連のサウンドやチャレンジ
- Redditで感情的な議論が起きている投稿
- 急上昇しているGoogleトレンド
- バズっているYouTube動画
- ニュース記事のコメント欄で熱い議論になっているトピック

D：バイラルパターン認識
特に以下の要素を含むトピックを重点的に探してください：
- 強い意見の対立がある（賛成派vs反対派）
- 感情を強く刺激する（怒り、喜び、驚き、憤慨）
- 多くの人が共感できる体験談
- 思わずシェアしたくなる驚きの事実
- 今すぐ知らないと損するタイムリーな話題
- ${platform}文化に合った面白さやミーム性
```

#### JSON出力形式
```json
{
  "TOPIC": "トピックのタイトル",
  "url": "メインの記事URL",
  "date": "公開日（YYYY-MM-DD形式）",
  "summary": "記事の詳細な要約（400文字）",
  "keyPoints": [
    "重要ポイント1",
    "重要ポイント2",
    "重要ポイント3",
    "重要ポイント4",
    "重要ポイント5"
  ],
  "perplexityAnalysis": "なぜこれがバズる可能性があるのか、感情的な要素や対立構造を含めて分析（200文字）",
  "additionalSources": [
    {
      "url": "追加ソースURL1",
      "title": "記事タイトル",
      "date": "公開日"
    }
  ]
}
```

### Step 2: コンセプト生成プロンプト（generate-concepts）

#### バージョン: 2025年6月18日版-v2（最新テスト版）

#### 変更履歴
- 2025年6月18日-v2: フックと角度の説明を改善、具体例を追加、conceptTitle追加、カルーセル削除（テスト予定）
- 2025年6月18日: 初版作成（3コンセプト×2トピック、方向性のみ記載）

#### システムプロンプト
```
あなたは、新たなトレンドを特定し、流行の波がピークに達する前にその波に乗るコンテンツのコンセプトを作成するバズるコンテンツ戦略家です。
```

#### ユーザープロンプト（2025年6月18日版-v2）
```
以下のトピックについて、【${platform}】で【${style}】スタイルでバズる投稿コンセプトを3つ作成してください。

トピック: ${topic.TOPIC}
分析: ${topic.perplexityAnalysis}
URL: ${topic.url}

【フック】

●以下の5種類のうちいずれか（または組み合わせ）を使って、心をつかむ「オープニングフック」を3つ考えてください：
    1.    意外性（Surprise）：常識の逆をつく／想定外の展開
    2.    緊急性（Urgency）：今すぐ知るべき／時間や期限を意識させる
    3.    自己投影（Identity）：読者が「自分のことだ」と感じる視点
    4.    数字・ロジック（Clarity）：データや具体性による説得力
    5.    問い・未完性（Tension）：答えが知りたくなる問いかけ／途中で止める余白

⸻

【角度】

●上記のフックを活かし、以下の観点をもとに"独自の切り口"を3つ構想してください：
    •    世の流れに対して"逆張りする"視点
    •    当事者や専門家の"リアルな声"に基づく分析
    •    個人的な体験や人間関係を起点とした"ストーリー型"
    •    背景や構造を解きほぐす"わかりやすい解説型"
    •    今後の動きや波及効果を読む"予測・考察型"
    •    見えづらい部分に焦点を当てる"舞台裏や裏話的視点"
    •    過去の出来事との"比較や参照"による構造的視点
    •    誤解や常識を覆す"神話破壊型"
    •    具体例を深堀りする"ケーススタディ型"
    •    統計やグラフで語る"データ駆動型"
    •    社会的課題を浮き彫りにする"問題提起型"
    •    実用的なヒントを提供する"ライフハック型"

⸻

【投稿構造】

●下記の流れに沿って、1投稿を構成してください：
    1.    オープニングフック
　👉 興味を引く最初の一文（驚き・問い・逆説 など）
　例：「たった1つの工夫で、仕事が3倍速くなるとしたら？」
    2.    背景／問題提起（Why）
　👉 なぜその話が今重要なのか／どんな課題を扱うのか
　例：「多くの人が、"情報に振り回される働き方"をしている」
    3.    具体的な中身（What/How）
　👉 ノウハウ・体験談・数字・ストーリーなど。箇条書きでも可
　例：「ぼくが試したのは、"朝10分だけの○○習慣"」
    4.    まとめ・内省・共感（So What）
　👉 読者に問いかける／共感を引き出す／価値づけする
　例：「大切なのは、ツールじゃなく"使い方"だった」
    5.    CTA（行動のきっかけ）
　👉 コメント・RT・保存・プロフィール誘導など
　例：「あなたの習慣術、よかったら教えてください」

⸻

【ビジュアル案】

●投稿の印象を高める画像や動画の方向性を提案してください。例：
    •    グラフや数字を強調したインフォグラフィック
    •    before→afterで変化が伝わる2枚比較画像
    •    感情に訴える写真（顔・手・空・紙などの抽象）
    •    手書き風の図解
    •    モノローグ系の静かな動画

⸻

【投稿タイミング】

●ターゲット層に合わせて、最適な投稿時間帯と曜日を提示してください。例：
    •    平日夜（21時〜23時）
    •    日曜夕方（「明日から」モードを活用）
    •    月曜朝（モチベーション系に強い）

【角度の組み合わせルール】
- 各コンセプトは異なる角度を使用すること
- 2-3個の角度を組み合わせる場合は、相乗効果を狙うこと
- 同じ角度の組み合わせを繰り返さないこと

また、構想したコンセプトが一目で分かるよう、各コンセプトに20文字以内のタイトルを付けてください。

構想したコンセプトにふさわしいのは単独投稿かツリー投稿かも指示してください。
- single: 単独投稿（140文字以内で完結）
- thread: ツリー投稿（複数の投稿で詳細に展開）

必ず以下のJSON形式で3つのコンセプトを出力してください：
```

#### JSON出力形式（2025年6月18日版-v2）
```json
[
  {
    "conceptId": "topic${topicIndex + 1}_concept1",
    "conceptTitle": "AIが変える意外な働き方の真実",
    "format": "single",
    "hookType": "使用したフックの種類（例：意外性）",
    "hookCombination": ["意外性", "問い・未完性"],
    "angle": "メイン角度（例：逆張りする視点）",
    "angleCombination": ["逆張りする視点", "舞台裏や裏話的視点"],
    "angleRationale": "なぜこの角度/組み合わせが効果的か（例：常識と真実のギャップが関心を引く。インパクトある事実は単独投稿で十分伝わる）",
    "viralScore": 85,
    "viralFactors": ["感情的反応を引き起こす", "シェアしたくなる新情報"],
    "structure": {
      "openingHook": "どのような驚きや問いかけで始めるか",
      "background": "どんな現状認識や問題意識を提示するか",
      "mainContent": "どんな事実・体験・分析を展開するか",
      "reflection": "どのような共感ポイントや価値づけをするか",
      "cta": "どんな行動を促すか（コメント・RT・保存など）"
    },
    "visual": "インフォグラフィック（数字を強調）",
    "timing": "平日夜21時（仕事終わりの振り返りタイム）",
    "hashtags": ["#AI時代の働き方", "#未来の仕事", "#テクノロジーと人間"]
  },
  {
    "conceptId": "topic${topicIndex + 1}_concept2",
    "conceptTitle": "現場から見たAI導入の本音",
    "format": "thread",
    "hookType": "緊急性",
    "hookCombination": ["緊急性", "自己投影"],
    "angle": "当事者や専門家のリアルな声",
    "angleCombination": ["リアルな声", "予測・考察型"],
    "angleRationale": "現場の生の声と将来予測の組み合わせが説得力を生む。複数の視点や体験談を展開するにはスレッド形式が最適",
    "viralScore": 82,
    "viralFactors": ["今すぐ知るべき情報", "自分ごととして捉えられる"],
    "structure": {
      "openingHook": "緊急性を感じさせる問いかけや事実提示（方向性）",
      "background": "なぜ今この話が重要なのかの背景説明（方向性）",
      "mainContent": "実例や専門家の意見を交えた詳細解説（方向性）",
      "reflection": "読者の立場に寄り添った共感メッセージ（方向性）",
      "cta": "体験談の共有を促すような呼びかけ（方向性）"
    },
    "visual": "before→afterの比較画像",
    "timing": "月曜朝7時（週始めのモチベーション）",
    "hashtags": ["#キャリアチェンジ", "#スキルアップ", "#働き方改革"]
  },
  {
    "conceptId": "topic${topicIndex + 1}_concept3",
    "conceptTitle": "データで読み解く働き方革命",
    "format": "thread",
    "hookType": "数字・ロジック",
    "hookCombination": ["数字・ロジック", "意外性"],
    "angle": "わかりやすい解説型",
    "angleCombination": ["解説型", "比較や参照による構造的視点"],
    "angleRationale": "データと歴史的視点の組み合わせで深い理解を促す。詳細な分析にはスレッド形式が適している",
    "viralScore": 88,
    "viralFactors": ["保存したくなる有益情報", "理解しやすい構造"],
    "structure": {
      "openingHook": "衝撃的な数字やデータから始める（方向性）",
      "background": "その数字が意味する社会的背景（方向性）",
      "mainContent": "ステップバイステップの解説や比較分析（方向性）",
      "reflection": "データから導かれる洞察や学び（方向性）",
      "cta": "保存やプロフィール訪問を促す（方向性）"
    },
    "visual": "グラフや統計データのスクリーンショット",
    "timing": "日曜夕方17時（明日からの準備モード）",
    "hashtags": ["#データで見る未来", "#ビジネストレンド", "#学び"]
  }
]
```

#### ユーザープロンプト（2025年6月18日版 - 旧版）
```
以下のトピックについて、【${platform}】で【${style}】スタイルでバズる投稿コンセプトを3つ作成してください。

トピック: ${topic.TOPIC}
分析: ${topic.perplexityAnalysis}
URL: ${topic.url}

【フック】
下記の5種類を戦略的に組み合わせて、多様なフックを考えてください
1. 意外性（Surprise）- 常識を覆す事実、逆説的な視点
2. 緊急性（Urgency）- 今知るべき理由、期限がある情報
3. 自己投影（Identity）- 読者が共感する立場、「あなたも」という視点
4. 数字・ロジック（Clarity）- 具体的データ、明確な根拠
5. 問い・未完性（Tension）- 答えを知りたくなる質問、議論を呼ぶ問題提起

【角度の多様性】
以下の12種類から、各コンセプトで異なる角度（または複数の角度の組み合わせ）を使用してください：
1. 反対派視点 - 世論に異議を唱える、逆張りの論理
2. 専門家分析 - 内部視点、業界の裏話、プロの見解
3. 個人体験談 - 実体験、感情的なストーリー
4. 教育的解説 - ステップバイステップ、初心者向け説明
5. 未来予測 - 次に起こること、トレンド予想
6. 舞台裏暴露 - 知られざる真実、裏側の仕組み
7. 歴史的比較 - 過去の類似事例、時代を超えた教訓
8. 神話破壊 - 誤解を解く、常識の嘘を暴く
9. ケーススタディ - 具体例の深堀り、成功/失敗分析
10. データ駆動 - 統計やグラフで語る、数字の力
11. 問題提起型 - 社会的課題、解決すべき問題
12. ライフハック - 実用的なヒント、すぐ使えるテクニック

【投稿構造】
下記の構造で、投稿構造を作成してください
1.オープニングフック
　👉 興味を引く1行（問い・驚き・結論の逆提示）
　※例：「たった1つの工夫で、仕事が3倍速くなるとしたら？」
2.背景／問題提起（Why）
　👉 なぜそれが重要なのか／何が問題なのか
　※例：「多くの人が"情報に振り回される働き方"をしてる」
3.具体的な中身／ストーリー（What/How）
　👉 ノウハウ・体験談・ストーリー・箇条書きでもOK
　※例：「ぼくが取り入れたのは、"朝10分の〇〇習慣"」
4.内省・共感・まとめ（So What）
　👉 読者の気持ちに寄り添い、意味づけ／価値化する
　※例：「大切なのは、ツールじゃなく"使い方"だった」
5.CTA（Call to Action）
　👉 リプ・RT・保存・プロフィール誘導など
　※例：「あなたの習慣術、よかったら教えて」

【ビジュアル案】
上記にふさわしいビジュアル案を提示してください

【投稿タイミング】
上記にふさわしい投稿タイミングを提示してください

【ハッシュタグ案】
上記にふさわしいハッシュタグを3つ提示してください

【重要な注意事項】
これはコンセプト（骨組み・設計図）の生成です。実際の投稿文を書くのではなく、どのような内容にするかの「方向性」「方針」「アプローチ」を示してください。

structure内の各要素には、具体的な文章ではなく、「どのような内容を含めるか」「どんなアプローチを取るか」「何を狙うか」という方向性を記載してください。

【角度の組み合わせルール】
- 各コンセプトは異なる角度を使用すること
- 2-3個の角度を組み合わせる場合は、相乗効果を狙うこと
- 同じ角度の組み合わせを繰り返さないこと
```

#### JSON出力形式
```json
[
  {
    "conceptId": "topic1_concept1",
    "format": "single",
    "hookType": "使用したフックの種類",
    "hookCombination": ["組み合わせた場合のフックタイプ"],
    "angle": "メイン角度",
    "angleCombination": ["使用した角度の組み合わせ"],
    "angleRationale": "なぜこの角度/組み合わせが効果的か",
    "viralScore": 85,
    "viralFactors": ["バズる要因1", "バズる要因2"],
    "structure": {
      "openingHook": "このトピックでどう興味を引くか（方向性）",
      "background": "どんな問題提起をするか（方向性）",
      "mainContent": "何を伝えるか（方向性）",
      "reflection": "どう共感を生むか（方向性）",
      "cta": "どんな行動を促すか（方向性）"
    },
    "visual": "ビジュアル案",
    "timing": "投稿タイミング",
    "hashtags": ["関連ハッシュタグ"]
  }
]
```

### Step 3: コンテンツ生成プロンプト（generate-contents）

#### バージョン: 2025年6月18日版（最新稼働版）

#### 変更履歴
- 2025年6月18日: 最新稼働版として記録（物語性を重視、選択されたコンセプトのみ処理）

#### システムプロンプト
```
あなたは、新たなトレンドを特定し、流行の波がピークに達する前にその波に乗るコンテンツのコンセプトを作成するバズるコンテンツ戦略家です。
```

#### ユーザープロンプト（概要）
```
以下のコンセプトを元に、【${platform}】で【${style}】スタイルの投稿を作成してください。

トピック: ${concept.topicTitle}
形式: ${concept.format}
フックタイプ: ${concept.hookType}
角度: ${concept.angle}

【コンセプトの投稿構造】
1. オープニングフック: ${concept.structure.openingHook}
2. 背景／問題提起: ${concept.structure.background}
3. 具体的な中身: ${concept.structure.mainContent}
4. 内省・共感・まとめ: ${concept.structure.reflection}
5. CTA: ${concept.structure.cta}

推奨ハッシュタグ: ${concept.hashtags.join(', ')}

【重要な指示】
- 物語性のある魅力的な投稿として完成させてください
- 指定された構造の流れに沿って展開してください
- ${platform}の文字数制限を考慮してください
- 感情的な共感と具体的な価値提供のバランスを取ってください
```

### 重要な実装上の注意事項

1. **プロンプトの完全性**
   - 上記のプロンプトは一字一句変更しない
   - 削除・省略・追加は厳禁
   - 変更が必要な場合は、このマスター仕様を更新する

2. **実装との同期**
   - 実装コードを変更する際は、必ずこのマスター仕様と照合
   - ドキュメントがマスター、実装は従
   - 「改善」と称した勝手な変更は禁止

3. **変数の扱い**
   - `${theme}`, `${platform}`, `${style}`は動的に置換
   - `theme.split('と')`の処理は要改善（固定的すぎる）

4. **出力の検証**
   - 各ステップの出力が次ステップの入力として適切か確認
   - フィールド名と内容の一致を確認

5. **バージョン管理**
   - プロンプトを変更した場合は必ず日付とともに記録
   - 古いバージョンはコメントアウトして残す

### なぜドキュメントベースなのか

実装されたコードは：
- Claudeが「改善」と称して勝手に変更する可能性がある
- ユーザーには変更が見えない（ブラックボックス）
- 複雑な条件分岐に埋もれて本来の意図が不明になる

だからこそ：
- **このドキュメントが唯一の真実（Single Source of Truth）**
- 実装はこのドキュメントに従う
- 疑問があればこのドキュメントを参照

## 📚 まとめ：プロンプトエンジニアリングの極意

### やってはいけないこと
1. プロンプトを関数的に設計する
2. ガイド要素を出力数と混同する
3. フィールド名を安易に決める
4. 各ステップを独立設計する
5. プロンプトを削る・簡略化する

### やるべきこと
1. LLMに考えさせる余地を残す
2. 次フェーズから逆算して設計
3. 意図が明確なフィールド名を使う
4. 全体の流れを意識した設計
5. 自然言語での詳細な指示

### 最も重要な教訓

> **最初のプロンプト理解が全てを決める**

一度間違った理解で実装が始まると、その誤解はシステム全体に波及し、修正が極めて困難になります。

> **動くけど意図と違うシステムが最も危険**

正しく動作しているように見えるが、本来の目的を果たしていないシステムは、発見も修正も困難です。

---

*このガイドは生きたドキュメントです。新たな知見が得られた際は、随時更新してください。*