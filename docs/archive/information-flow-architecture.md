# BuzzFlow 情報フローアーキテクチャ

## 理想的な情報フロー（2025年1月版）

### 1. データ収集フェーズ（毎朝6:00）
```
┌─────────────────┐     ┌─────────────────┐
│  ニュース収集   │     │ バズツイート収集 │
│  - RSS Feed     │     │  - Kaito API    │
│  - 重要度分析   │     │  - 複数切り口   │
└────────┬────────┘     └────────┬────────┘
         │                       │
         └───────────┬───────────┘
                     ▼
            ┌─────────────────┐
            │  データ統合      │
            │  - トレンド抽出  │
            │  - 相関分析      │
            └────────┬────────┘
```

### 2. AI分析フェーズ（毎朝6:30）
```
         ┌─────────────────────┐
         │   Perplexity分析    │
         │ ・最新トレンド      │
         │ ・あなたの視点      │
         │ ・バズ予測         │
         └──────────┬──────────┘
                    ▼
         ┌─────────────────────┐
         │  投稿計画生成       │
         │ ・1日10-20件       │
         │ ・時間帯別最適化   │
         │ ・種類別振り分け   │
         └─────────────────────┘
```

### 3. 投稿実行フェーズ（終日）
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│ 引用RT      │     │ コメント付  │     │ 独自投稿    │
│ (5-8件/日)  │     │ 引用RT      │     │ (3-5件/日)  │
│             │     │ (3-5件/日)  │     │             │
└─────────────┘     └─────────────┘     └─────────────┘
```

### 4. 分析・学習フェーズ（毎晩23:00）
```
         ┌─────────────────────┐
         │   投稿結果分析      │
         │ ・エンゲージメント │
         │ ・成功パターン     │
         └──────────┬──────────┘
                    ▼
         ┌─────────────────────┐
         │   学習・最適化      │
         │ ・検索クエリ調整   │
         │ ・投稿時間最適化   │
         └─────────────────────┘
```

## 現在の実装状況

### ✅ 実装済み
1. ニュース収集（RSS）
2. バズツイート収集（Kaito API）
3. Perplexity統合分析
4. 投稿作成画面（レコメンド付き）
5. 基本的なスケジューリング

### ⚠️ 部分的に実装
1. 投稿計画の自動生成
2. 投稿結果の分析

### ❌ 未実装
1. 自動振り分けロジック
2. 自動投稿
3. ABテスト
4. 学習ループ

## 推奨される次のステップ

### Phase 1: 自動投稿計画（1週間）
```javascript
// 投稿計画生成API
POST /api/posting-plan/generate
{
  perplexityReport: {...},
  buzzPosts: [...],
  newsHighlights: [...],
  targetCount: 15 // 1日の投稿数
}

// レスポンス
{
  plan: [
    {
      type: "quote_rt",
      targetPost: {...},
      suggestedContent: "...",
      scheduledTime: "2025-01-12T09:00:00Z",
      reasoning: "高エンゲージメント投稿への価値追加"
    },
    {
      type: "original",
      theme: "AI×クリエイティブ",
      suggestedContent: "...",
      scheduledTime: "2025-01-12T21:00:00Z",
      reasoning: "夜の深い洞察系コンテンツ"
    }
  ]
}
```

### Phase 2: 自動投稿実行（2週間）
- Twitter API統合強化
- スケジューラー実装（Vercel Cron）
- エラーハンドリング

### Phase 3: 分析・学習ループ（3週間）
- 詳細な分析ダッシュボード
- 成功パターンの自動抽出
- 検索クエリの動的最適化

## データフローの強化ポイント

### 1. バズツイート収集の多様化
```javascript
const collectionStrategies = [
  // 基本戦略
  { query: "AI クリエイティブ", minLikes: 1000 },
  
  // 異常値狙い
  { query: "ChatGPT 衝撃", minLikes: 5000 },
  
  // ニッチ高品質
  { query: "プロンプトエンジニアリング", minLikes: 300 },
  
  // 対話的
  { query: "AI 議論 質問", minLikes: 500 }
];
```

### 2. Perplexityプロンプトの強化
```javascript
const enhancedPrompt = `
あなたは50代クリエイティブディレクターです。
以下の情報を基に、今日の投稿戦略を立ててください：

【最新ニュース】
${newsContext}

【バズっている話題】
${buzzingTopics}

【あなたの強み】
- 23年の映像制作経験
- プロジェクションマッピングの先駆者
- 技術変革を何度も経験

【求める出力】
1. 朝（7-9時）：実践的Tips系 × 3案
2. 昼（12-13時）：ニュースへのRP × 2案  
3. 夜（21-23時）：深い洞察系 × 2案
`;
```

### 3. 成功メトリクスの定義
```javascript
const successMetrics = {
  // 即時指標
  engagementRate: views > 0 ? (likes + retweets) / views : 0,
  viralScore: retweets / likes, // RT率が高い = 拡散力
  
  // 長期指標
  followerGrowth: newFollowers / posts,
  reachExpansion: uniqueReachers / followers,
  
  // 質的指標
  discussionQuality: replies.filter(r => r.length > 50).length,
  influencerEngagement: engagements.filter(e => e.followerCount > 10000).length
};
```

## まとめ

現在のシステムは基本的な情報収集と分析は実装済みですが、自動化と学習ループがまだ不完全です。上記のアーキテクチャに従って段階的に実装することで、真の自動化システムが完成します。